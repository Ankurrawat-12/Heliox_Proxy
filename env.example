# Heliox Proxy Configuration
# Copy this file to .env and configure for your environment

# =============================================================================
# DATABASE
# =============================================================================
DATABASE_URL=postgresql+asyncpg://heliox:heliox_password@localhost:5432/heliox
DATABASE_URL_SYNC=postgresql://heliox:heliox_password@localhost:5432/heliox

# =============================================================================
# REDIS
# =============================================================================
# Set to empty string to enable Demo Mode (in-memory fallback)
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# APPLICATION
# =============================================================================
SECRET_KEY=your-secret-key-change-in-production
ADMIN_API_KEY=admin-secret-key-change-me
DEBUG=true
LOG_LEVEL=INFO

# =============================================================================
# GATEWAY SETTINGS
# =============================================================================
# Default timeout for upstream requests (ms)
DEFAULT_UPSTREAM_TIMEOUT_MS=30000

# Maximum body size to cache (bytes)
MAX_CACHE_BODY_SIZE=10485760

# =============================================================================
# RATE LIMITING
# =============================================================================
# Default rate limit per key (requests per second)
DEFAULT_RATE_LIMIT_RPS=100

# Default burst size
DEFAULT_RATE_LIMIT_BURST=200

# =============================================================================
# ABUSE DETECTION
# =============================================================================
# EWMA decay factor (0-1, higher = more weight on recent)
ABUSE_EWMA_ALPHA=0.3

# Z-score threshold for anomaly detection
ABUSE_ZSCORE_THRESHOLD=3.0

# Soft block duration (seconds)
ABUSE_BLOCK_DURATION_SECONDS=300

# =============================================================================
# BLOOM FILTER (Negative Caching)
# =============================================================================
# Expected number of 404 paths
BLOOM_EXPECTED_ITEMS=10000

# Desired false positive rate
BLOOM_FALSE_POSITIVE_RATE=0.01

# =============================================================================
# CELERY / WORKER
# =============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# =============================================================================
# CORS (for Admin UI)
# =============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================
# full | demo
DEPLOYMENT_MODE=full

# Auto-seed database with sample data on startup
AUTO_SEED=true

# =============================================================================
# EXTERNAL SERVICES (for free tier deployments)
# =============================================================================
# Neon/Supabase Postgres
# NEON_DATABASE_URL=

# Upstash Redis
# UPSTASH_REDIS_URL=

# =============================================================================
# ADMIN UI
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8000

# =============================================================================
# EMAIL - Option 1: Resend (RECOMMENDED for cloud platforms like Render/Vercel)
# =============================================================================
# Sign up at https://resend.com (free tier: 100 emails/day)
# SMTP is often blocked on cloud platforms, Resend API works reliably
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxx
RESEND_FROM_EMAIL=onboarding@resend.dev

# =============================================================================
# EMAIL - Option 2: SMTP (may be blocked on some cloud platforms)
# =============================================================================
# For Gmail, use an App Password if 2FA is enabled
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM_EMAIL=your-email@gmail.com
SMTP_FROM_NAME=Heliox

# Frontend URL for email links
FRONTEND_URL=http://localhost:3000

# =============================================================================
# RAZORPAY (Payment Gateway)
# =============================================================================
# Get your keys from https://dashboard.razorpay.com/app/keys
RAZORPAY_KEY_ID=rzp_test_xxxxxxxxxxxxx
RAZORPAY_KEY_SECRET=xxxxxxxxxxxxxxxxxxxxx
RAZORPAY_WEBHOOK_SECRET=